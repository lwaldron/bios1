<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bios1">
<title>Lab 6: Image analysis to predict malignant breast cancer logistic regression • bios1</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Lab 6: Image analysis to predict malignant breast cancer logistic regression">
<meta property="og:description" content="bios1">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bios1</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Homework1.html">BIOS 1 - Homework 1</a>
    <a class="dropdown-item" href="../articles/Lab5.html">Lab 5: Writing and debugging a function in R</a>
    <a class="dropdown-item" href="../articles/Lab6.html">Lab 6: Image analysis to predict malignant breast cancer logistic regression</a>
    <a class="dropdown-item" href="../articles/Tutorial5.html">Tutorial 5</a>
    <a class="dropdown-item" href="../articles/cancer_reg.html">Cancer Death vs Poverty by County in US</a>
    <a class="dropdown-item" href="../articles/standardization_simplified.html">Standardization simplified</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Lab 6: Image analysis to predict malignant breast cancer logistic regression</h1>
                        <h4 data-toc-skip class="author">Biostatistics
1</h4>
            
      
      
      <div class="d-none name"><code>Lab6.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="learning-objectives">Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ul>
<li>Identify and correct a problematic data file</li>
<li>perform exploratory data analysis with a binary variable</li>
<li>perform logistic regression in R using the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>
function</li>
<li>identify collinearity among many numeric variables</li>
<li>interpret logistic regression coefficients in a predictive
setting</li>
<li>use a logistic regression model to predict probabilities of a binary
outcome</li>
<li>use <code>tidyr</code> to pivot from a wide format to a long format
dataframe</li>
<li>use ggplot2’s <code>facet_wrap()</code> to create multiple
plots</li>
<li>overlay a line plot of predicted probabilities over an xy plot of
data points</li>
</ul>
</div>
<div class="section level2">
<h2 id="materials">Materials<a class="anchor" aria-label="anchor" href="#materials"></a>
</h2>
<ul>
<li>RStudio or any R environment</li>
<li>Dataset: <code>breast cancer.csv</code> (<a href="https://raw.githubusercontent.com/lwaldron/bios1/main/vignettes/breast%20cancer.csv" class="external-link">download</a>).
This dataset contains an outcome variable “diagnosis” with values B
(benign) and M (malignant), and a number of cellular pathologic features
representing the properties of cells as calculated by an image analysis
algorithm. Each row corresponds to a patient who underwent a tissue
biopsy. Here is <a href="http://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+%28Diagnostic%29" class="external-link">more
information about the dataset</a> if you are interested.</li>
<li>R packages: readr, dplyr, ggplot2, tidyr, possibly
ComplexHeatmap</li>
</ul>
</div>
<div class="section level2">
<h2 id="importing-the-dataset">1. Importing the Dataset<a class="anchor" aria-label="anchor" href="#importing-the-dataset"></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li>Import the dataset (<code>breast cancer.csv</code>) into R, using
<code>readr</code>. What is the problem with the 33rd column causing a
warning? Fix this problem in the data file, then try again. Import
<code>id</code> as a character, and <code>diagnosis</code> as a factor
with values B and M.</li>
<li>Recode the “diagnosis” column to the more informative values
“benign” and “malignant”, with reference level “benign”</li>
</ol>
</div>
<div class="section level2">
<h2 id="exploratory-data-analysis-eda">2. Exploratory Data Analysis (EDA)<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis-eda"></a>
</h2>
<p>For each part of this question, write out something you notice from
the data exploration, such as variable type, if and where there are
missing values. There are no right/wrong answers for this, it is just to
get practice interpreting EDA.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Check the dimensions of the dataset using the dim()
function</p></li>
<li><p>Preview the first few rows of the dataset using the head()
function</p></li>
<li><p>Use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to summarize the dataset.</p></li>
<li><p>Identify collinear variables.</p></li>
</ol>
<p>The following command, run on a wide dataframe, will calculate 1
minus the pairwise Pearson correlation between each pair of numeric
variables in the dataset. This represents a distance matrix between
variables, where “0” means two variables that are identical or perfectly
anti-correlated, and “1” means two variables have zero correlation. We
use 1 minus the absolute value of the correlations so that it becomes a
distance measure instead of a correlation measure.</p>
<p>Plot this distance matrix to identify the most highly correlated or
anticorrelated variables. A few ways you could do this is (if your
distance matrix is called <code>d</code>) are as follows - try them and
choose your favorite. You may want to increase the size of the figure
output again.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>or:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu">pheatmap</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Create a box plot for each column except for <code>id</code>. Each
boxplot should have two boxes, one for benign and one for malignant,
allowing visual comparison of the distribution of that variable for
benign and malignant specimens. Do any variables clearly have an
association with breast cancer diagnosis?</li>
</ol>
<p><em>Hints for e:</em></p>
<ol style="list-style-type: decimal">
<li>Create a new dataset without the <code>id</code> variable, then use
the <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer</a></code> function to create a “long”
dataframe with 3 columns: 1. diagnosis, 2. the name of the column from
the “wide” dataframe, and 3. a column containing all the numeric values.
The first example from the <code>pivot_longer</code> help page
(“Simplest case where column names are character data”) is exactly
analogous to what you need to do.</li>
<li>With this “long” dataset you can add a <code>facet_wrap()</code>
command to your ggplot to create a box plot for each variable in a grid.
Use the <code>scales</code> argument to use “free” scales so that each
box plot can have a different scale, so that you can read each box
plot.</li>
<li>Use the knitr chunk options <code>fig.width=10</code> and
<code>fig.height=10</code> to increase the size of the figure to make
theaxis labels readable.</li>
</ol>
</div>
<div class="section level2">
<h2 id="building-a-logistic-regression-model">3. Building a Logistic Regression Model<a class="anchor" aria-label="anchor" href="#building-a-logistic-regression-model"></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Fit a univariate logistic regression model using
<code>area_mean</code> as the predictor and <code>diagnosis</code> as
the outcome, using the <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> function</p></li>
<li><p>Print the summary of the model using the summary()
function</p></li>
<li><p>Interpret the coefficients of the logistic regression
model</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="making-predictions">4. Making predictions<a class="anchor" aria-label="anchor" href="#making-predictions"></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Create a xy plot with <code>area_mean</code> of the x axis and
<code>diagnosis</code> on the y axis. Use
<code>geom_jitter(width = 0)</code> to create some spread on the y-axis
so you can see where the points are without changing the x
values.</p></li>
<li><p>Now add to this plot the predicted probabilities for each
observed temperature, using the <code>predict</code> function with
argument <code>type="response"</code>.</p></li>
</ol>
<p><em>Hint:</em> First add a column of predicted probabilities to the
<code>breast_cancer</code> dataframe. You will have to add 1 to these
probabilities to make them on the same scale as the data points. Then
you can add a <code>geom_line()</code> to the previous plot, with its
own <code>aes()</code>, to add the line.</p>
<p><em>Suggestion:</em> Change the line color and increase its width to
make it more visible.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>What do you notice about the data points where the predicted
probabilities are 0, 0.5, and 1?</p></li>
<li><p>What are the predicted probabilities of a malignant diagnosis
when <code>area_mean</code> is 300, 500, 700, 900, and 1100?</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Levi Waldron, Zach Shahn, Marcel Ramos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
