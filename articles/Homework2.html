<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bios1">
<title>BIOS 1 - Homework 2 • bios1</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BIOS 1 - Homework 2">
<meta property="og:description" content="bios1">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bios1</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Homework1.html">BIOS 1 - Homework 1</a>
    <a class="dropdown-item" href="../articles/Homework2.html">BIOS 1 - Homework 2</a>
    <a class="dropdown-item" href="../articles/Lab5.html">Lab 5: Writing and debugging a function in R</a>
    <a class="dropdown-item" href="../articles/Lab6.html">Lab 6: Image analysis to predict malignant breast cancer using logistic regression</a>
    <a class="dropdown-item" href="../articles/Tutorial5.html">Tutorial 5</a>
    <a class="dropdown-item" href="../articles/cancer_reg.html">Cancer Death vs Poverty by County in US</a>
    <a class="dropdown-item" href="../articles/standardization_simplified.html">Standardization simplified</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>BIOS 1 - Homework 2</h1>
                        <h4 data-toc-skip class="author">Levi
Waldron</h4>
            
            <h4 data-toc-skip class="date">2023-05-03</h4>
      
      
      <div class="d-none name"><code>Homework2.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="source-code-and-data-for-this-assignment">Source code and data for this assignment<a class="anchor" aria-label="anchor" href="#source-code-and-data-for-this-assignment"></a>
</h2>
<p><em>Note</em>: The code used to create this document is <a href="https://github.com/lwaldron/bios1/blob/main/vignettes/Homework2.Rmd" class="external-link">here</a>.</p>
<p>In this homework we will again use the NHEFS dataset. Take a look at
the codebook linked to from <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/" class="external-link uri">https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/</a>.</p>
<p>This time we will test the hypothesis that quitting smoking between
1971 and 1981 (variable <code>qsmk</code>) reduces the probability of
death by 2001 (variable <code>death</code>).</p>
</div>
<div class="section level2">
<h2 id="data-import-and-recoding">Data import and recoding<a class="anchor" aria-label="anchor" href="#data-import-and-recoding"></a>
</h2>
<p>Download the dataset, import it into R, and recode variables as
instructed in <a href="https://lwaldron.github.io/bios1/articles/Homework1.html">Homework
1</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="va">nhefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="question-1-2-points-filter-any-missing-data">Question 1 (2 points): filter any missing data<a class="anchor" aria-label="anchor" href="#question-1-2-points-filter-any-missing-data"></a>
</h2>
<p>Remove any observations that are missing any of the following
variables:</p>
<ul>
<li><code>death</code></li>
<li><code>active</code></li>
<li><code>age</code></li>
<li><code>education</code></li>
<li><code>exercise</code></li>
<li><code>qsmk</code></li>
<li><code>race</code></li>
<li><code>sex</code></li>
<li><code>smokeintensity</code></li>
<li><code>smkyrs</code></li>
<li><code>wt82_71</code></li>
</ul>
<p>You would ordinarily want to perform a sensitivity analysis and
consider the possibility of bias from informative censoring, but you can
ignore that possibility for the purposes of this assignment.</p>
</div>
<div class="section level2">
<h2 id="question-2-4-points-table-1">Question 2 (4 points): Table 1<a class="anchor" aria-label="anchor" href="#question-2-4-points-table-1"></a>
</h2>
<p>Create a table of descriptive statistics like in HW1, but this time
stratify it by the exposure variable <code>qsmk</code></p>
</div>
<div class="section level2">
<h2 id="question-3-4-points-fit-crude-and-adjusted-logistic-regression-models">Question 3 (4 points): fit crude and adjusted logistic regression
models<a class="anchor" aria-label="anchor" href="#question-3-4-points-fit-crude-and-adjusted-logistic-regression-models"></a>
</h2>
<p>Fit simple and adjusted multiple logistic regression models for the
probability of death with quitting smoking as the exposure. In the
multivariate model, adjust for sex, race, age, education, and exercise
as hypothesized confounders. Use a B-spline from the
<code>splines</code> package to correct for age, ie:</p>
<p><span class="math display">\[
death \sim qsmk + sex + race + bs(age) + education + exercise
\]</span></p>
<p>For the purpose of this question, assume that conditional
exchangeability holds when controlling for these confounders.</p>
<p><strong>Interpret the coefficient of <code>qsmk</code> in the crude
model and in the adjusted model. Compare them.</strong></p>
</div>
<div class="section level2">
<h2 id="question-4-3-points-model-diagnostics">Question 4 (3 points): model diagnostics<a class="anchor" aria-label="anchor" href="#question-4-3-points-model-diagnostics"></a>
</h2>
<p>Create a binned residual plot using the <code>binnedplot</code>
function from the <code>arm</code> library. Interpret the plot.</p>
</div>
<div class="section level2">
<h2 id="question-5-7-points-inverse-probability-weighting">Question 5 (7 points): Inverse probability weighting<a class="anchor" aria-label="anchor" href="#question-5-7-points-inverse-probability-weighting"></a>
</h2>
<p>a (2 points)) Create a model to calculate the propensity of exposure
given the values of the hypothesized confounders (propensity score).
This is your “denominator” model of Lecture 11, Slide 15. ie,</p>
<p><span class="math display">\[
\textbf{denom.fit}:qsmk \sim sex + race + bs(age) + education + exercise
\]</span></p>
<p>Also fit your “numerator model”, <span class="math display">\[
\textbf{num.fit}: qsmk \sim 1
\]</span></p>
<p>b (2 points)) Calculate IPTW weights using this model. Hint - you can
use code like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdenom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">denom.fit</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">pnum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">num.fit</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">nhefs</span><span class="op">$</span><span class="va">iptw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">nhefs</span><span class="op">$</span><span class="va">qsmk</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pn.qsmk</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pd.qsmk</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     <span class="op">(</span><span class="va">pn.qsmk</span><span class="op">/</span><span class="va">pd.qsmk</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>c (2 points)) Use the <code>geeglm</code> function from the
<code>geepack</code> library to use these weights to estimate the causal
effect of quitting smoking on death.</p>
<p>Notes: - the <code>id</code> argument to <code>geepack</code> is
arbitrary in this case because there is no grouping or hierarchical
structure of participants. You can use the <code>seqn</code> variable or
<code>1:nrow(nhefs)</code>. - The <code>corstr</code> argument is also
arbitrary for the same reason; if you don’t specify it you will be using
the default <code>corstr="independence"</code> - Remember that when
using these weights, <em>do not</em> include confounders in the
model.</p>
<p>d (1 point)) Compare the coefficient and standard error for quitting
smoking to Question 2, and comment. Recall the discussion in lecture
about <code>geepack</code> standard errors being too conservative.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Levi Waldron, Zach Shahn, Marcel Ramos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
